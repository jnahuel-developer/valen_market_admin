Tengo un proyecto en Flutter, con la siguiente descripci√≥n:

# Proyecto "valen_market_admin"


------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------


## Objetivo:

Desarrollar e implementar un sistema que gestione los clientes, los productos y las ventas de un vendedor minorista.
El sistema tiene que ser multiplataforma, ya que deber√° contar con una implementaci√≥n para Android, para IOS y para Web.
Deber√° contar con una base de datos online de clientes, productos y ventas. La base de ventas ser√° relacional a las otras 2.

Desde cualquier interfaz se deber√° contar con un men√∫ para gestionar:
 - El alta, baja, modificaci√≥n y consulta de los clientes;
 - El alta, baja, modificaci√≥n y consulta de los productos del cat√°logo;
 - El alta, baja, modificaci√≥n y consulta de las fichas de ventas;
 - Las promociones de los productos;

Desde la implementaci√≥n de Android se deber√° contar adem√°s con un men√∫ para gestionar:
 - Los recorridos a realizar por el cobrador seg√∫n las fichas;


Desde la implementaci√≥n de IOS y Web se deber√° contar adem√°s con un men√∫ para gestionar:
 - El volcado de las bases de datos hacia planillas online de Excel;


------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------


## Implementaci√≥n tecnol√≥gica:

Ser√° dise√±ado utilizando la tecnolog√≠a Flutter, implementando un Kernel com√∫n y un flujo independiente para las interfaces.
Se contar√° con colecciones en Firestore para almacenar los datos:
 - /BDD_Admins -> Se almacenar√°n los datos de los Admins que pueda acceder al sistema;
 - /BDD_Catalogo -> Se almacenaran todos los datos de los productos;
 - /BDD_Clientes -> Se almacenaran todos los datos de los clientes;
 - /BDD_Fichas -> Se almacenaran todos los datos de las fichas de ventas. Cada entrada tendr√° una referencia a la tabla de clientes y cat√°logo;
 - /config -> Contendr√° todos los datos importantes de configuraci√≥n y control de la aplicaci√≥n;

Los admins deber√°n crearse una cuenta en el sistema con un mail de GMail, ya que se usa el sistema de Authenticator de Google para validarlos.
Una vez que se registren, se crear√° un documento en BDD_Admins con el UID del usuario generado por Google.
Esto permitir√° enlazar los registros con el Authenticator, para poder revocar permisos f√°cilmente ante una falla o ingreso indebido.

Se contar√° con la API de Dropbox para manejar todas las im√°genes de los productos desde all√≠.
Cuando se agregue un producto a la base de datos, se cargar√° la imagen en una carpeta especial dentro de Dropbox.
Mediante las APIs, se obtendr√° un enlace directo al recurso, y se guardar√° en la entrada del producto en la colecci√≥n BDD_Catalogo.
Los widgets que expondr√°n los productos acceder√°n a las im√°genes de los mismos mediante los links en la entrada de cada producto.

El Kernel o los recursos en com√∫n entre las diferentes implementaciones deber√°n acceder mediante una capa de abstracci√≥n.
No se deben generar accesos dependientes de la plataforma directamente desde las pantallas o los widgets.


------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------


## Normas de dise√±o:

La aplicaci√≥n tiene 2 entornos de trabajo en uso:
 - Dev  -> Entorno para las pruebas de desarrollo y datos dummies;
 - Prod -> Entorno productivo y real;

En el punto de ingreso se define qu√© entorn√≥ se utilizar en la ejecuci√≥n.
Esto permite validar todas las modificaciones en el entorno de desarrollo antes de llevarlas a producci√≥n.

Se implementan distintos tipos de testeos, desde los CRUDs a la base de datos hasta los de Integraci√≥n en Android.

Se definen las reglas obligatorias de dise√±o en el archivo "Design_Rules.md".

La rama principal ser√° la rama "master". Esta integrar√° todos los desarrollos en estado productivo.
La rama de trabajo para la implementaci√≥n de la Web ser√° "developWeb". √âsta contendr√° todos los desarrollos para la plataforma Web.
La rama de trabajo para la implementaci√≥n de Android ser√° "developAndroid". √âsta contendr√° todos los desarrollos para la plataforma Android.
La rama de trabajo en desarrollo ser√° "modxxxx", independientemente de la plataforma en uso.

S√≥lo existir√°n 2 admins que tendr√°n los mismos niveles de privilegios.
Un admin acceder√° s√≥lo desde la aplicaci√≥n en Android desde su celular personal, con el cual har√° los recorridos.
El otro admin s√≥lo acceder√° a la versi√≥n Web, ya sea desde su computadora personal o desde su tel√©fono personal.
Por lo que la implementaci√≥n Web debe ser adaptada tanto para Desktop como para Mobile. S√≥lo cambia la interfaz gr√°fica, no el funcionamiento.
La direcci√≥n web no ser√° compartida a nadie m√°s que a los admins, con lo que no habr√° accesos externos.
El admin Web s√≥lo usar√° su comptadora personal, que no comparte con nadie m√°s. No hay posibilidades de que ingrese alguien ajeno con su cuenta.
Llegado el caso de que haya un acceso no aturoizado, se eliminar√° el registro de la base de datos de admins y ya no tednr√° m√°s permisos de acceso.


------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------


## Flujo de trabajo:

------------------------------------------------------------------------------------------

### Logueo y creaci√≥n de usuarios:

En primer instancia, independientemente de la plataforma, el usuario debe crearse una cuenta nueva en el sistema.
Luego, deber√° validar su mail.
Una vez dado de alta, el sistema lo enlazar√° con su UID.
Este dato debe ser almacenado en memoria persistente (esto depender√° de la plataforma, por eso la capa de abstracci√≥n intermedia).
El objetivo es que en los siguientes logueos sucesivos, si ya se encuentra registrado, no tenga que volver a pasar por todo el proceso de nuevo.

En el caso de la versi√≥n Web, luego de loguearse con la cuenta del sistema, deber√° otorgar permisos para utilizar los servicios de GMail.
Esta autorizaci√≥n es necesaria para poder acceder a las hojas de c√°lculo online.

Posteriormente a esto, desde cualquier plataforma se requerir√° abrir un enlace a Dropbox, para permitir el uso de la cuenta.
Esto otogar√° los permisos correctos para usar las APIs, y devolver√° un refresh_token.

En resumen, el proceso de logueo ser√°:
 - Introducir el mail y contrase√±a con que se haya dado de alta en el sistema;
 - (S√≥lo en la versi√≥n Web) Permitir el acceso a la cuenta de GMail;
 - Permitir el acceso a la cuenta de Dropbox;

El sistema debe almacenar los datos necesarios en memoria permanente, para validar el estado de logueo en los siguientes ingresos.
Si el usuario ya se encuentra logueado, y los datos siguen siendo v√°lidos, debe pasar directamente al men√∫ principal.
Si el permiso a la cuenta de GMail expir√≥, debe volver a solicitarlo.
Si el acceso a Dropbox expir√≥, debe intentar regenerarlo con el refresh_token. De no poder, debe volver a solicitarle el permiso al usuario.
En el documento "/config/dropbox", se encuentran alojadas las Keys para acceder a la API.
Durante el uso de la aplicaci√≥n, si alg√∫n acceso falla por expiraci√≥n, debe indicarle al usuario que se cerrar√° la sesi√≥n, y enviarlo al men√∫ de logueo inicial.

------------------------------------------------------------------------------------------

### Men√∫ principal

Deber√° listar las opciones disponibles para manejarse por la app.
Independientemente de la plataforma, deber√° mostrar las opciones para acceder al men√∫ de clientes, de productos y de fichas.
En la versi√≥n Web, deber√° adem√°s mostrar las opciones para acceder al men√∫ de volcado de fichas.
En la versi√≥n de Android, deber√° adem√°s mostrar las opciones para acceder al men√∫ de recorrido.

------------------------------------------------------------------------------------------

### Men√∫ de clientes

Deber√° mostrar las opciones de "Agregar", "Buscar", "Modificar" y "Eliminar", que funcionar√°n seg√∫n:
 - Agregar  ->  Presentar√° los controles necesarios para ingresar todos los datos de un nuevo cliente.
                Deber√° hacer uso de validaciones para cada campo.
 - Buscar   ->  Presentar√° los controles de "Nombre", "Apellido", "Zona" y "Tel√©fono" para usar de filtrados.
                Deber√° mostrar un listado con todos los resultados de la b√∫squeda.
                Luego presentar√° una pantalla de informaci√≥n con los datos del cliente seleccionado.
                Esta pantalla deber√° mostrar los mismos datos que la pantalla de "Agregar".
                Deber√° mostrar botones para "Editar" y para "Eliminar" el registro seleccionado.
                Si se ingres√≥ desde el men√∫ de "Editar", deber√° mostrar s√≥lo el bot√≥n de "Editar".
                Si se ingres√≥ desde el men√∫ de "Eliminar", deber√° mostrar s√≥lo el bot√≥n de "Eliminar".
 - Editar   ->  Deber√° mostrar el men√∫ de la opci√≥n de "Buscar".
                Cuando se seleccione un registro, deber√° mostrar s√≥lo el bot√≥n de "Editar".
 - Eliminar ->  Deber√° mostrar el men√∫ de la opci√≥n de "Buscar".
                Cuando se seleccione un registro, deber√° mostrar s√≥lo el bot√≥n de "Eliminar".

En la versi√≥n Web, deber√° adem√°s contar con los botones de "Cargar" y "Guardar", que funcionar√°n seg√∫n:
 - Cargar   ->  Deber√° abrir un cuadro de b√∫squeda de archivos para que el usuario cargue un Excel con registros de clientes.
                Validar√° el formato de los ingresos, y los agregar√° a la colecci√≥n de clientes.
 - Guardar  ->  Deber√° volcar todos los registros de la colecci√≥n de clientes a una hoja de Excel online.
                El nombre del archivo ser√° la combinaci√≥n de un Header, m√°s la fecha y hora de creaci√≥n.

------------------------------------------------------------------------------------------

### Men√∫ de productos

Deber√° mostrar las opciones de "Ver cat√°logo", "Buscar", "Modificar" y "Eliminar", que funcionar√°n seg√∫n:
 - Ver cat√°logo  ->  Mostrar√° todos los productos disponibles en la colecci√≥n del cat√°logo.
 - Agregar  ->  Presentar√° los controles necesarios para ingresar todos los datos de un nuevo producto.
                Deber√° hacer uso de validaciones para cada campo.
 - Buscar   ->  Presentar√° los controles de "Nombre", "Descripci√≥n corta", "Precio" y "Stock" para usar de filtrados.
                Deber√° mostrar un listado con todos los resultados de la b√∫squeda.
                Luego presentar√° una pantalla de informaci√≥n con los datos del producto seleccionado.
                Esta pantalla deber√° mostrar los mismos datos que la pantalla de "Agregar".
                Deber√° mostrar botones para "Editar" y para "Eliminar" el registro seleccionado.
                Si se ingres√≥ desde el men√∫ de "Editar", deber√° mostrar s√≥lo el bot√≥n de "Editar".
                Si se ingres√≥ desde el men√∫ de "Eliminar", deber√° mostrar s√≥lo el bot√≥n de "Eliminar".
 - Editar   ->  Deber√° mostrar el men√∫ de la opci√≥n de "Buscar".
                Cuando se seleccione un registro, deber√° mostrar s√≥lo el bot√≥n de "Editar".
 - Eliminar ->  Deber√° mostrar el men√∫ de la opci√≥n de "Buscar".
                Cuando se seleccione un registro, deber√° mostrar s√≥lo el bot√≥n de "Eliminar".

En la versi√≥n Web, deber√° adem√°s contar con los botones de "Cargar" y "Guardar", que funcionar√°n seg√∫n:
 - Cargar   ->  Deber√° abrir un cuadro de b√∫squeda de archivos para que el usuario cargue un Excel con registros de clientes.
                Validar√° el formato de los ingresos, y los agregar√° a la colecci√≥n de clientes.
 - Guardar  ->  Deber√° volcar todos los registros de la colecci√≥n de clientes a una hoja de Excel online.
                El nombre del archivo ser√° la combinaci√≥n de un Header, m√°s la fecha y hora de creaci√≥n.

A su vez, cada producto ser√° mostrado en un Widget que contendr√° 3 botones especiales:
 - Promoci√≥n    ->  A futuro permitir√° enviar notificaciones de promociones sobre ese producto a los clientes.
 - Editar       ->  Deber√° mostrar la pantalla de edici√≥n con los datos del producto seleccionado.
 - Eliminar     ->  Deber√° eliminar de la base el producto seleccionado.

------------------------------------------------------------------------------------------

### Men√∫ de fichas

Deber√° mostrar una pantalla que tendr√° 2 secciones:
 - A izquierda, un panel para controlar el registro de clientes.
 - A derecha, un panel para controlar el registro de productos.

En el panel izquierdo de control de los clientes, se tendr√° una lista desplegable con toda la colecci√≥n de clientes.
Los ingresos en la lista se mostrar√°n con el formato "Nombre Apellido".
Una vez seleccionado un registro, se cargar√°n todos los controls debajo con los datos de ese registro.
Los controles de "Nombre", "Apellido" y "Zona" tendr√°n un checkbox a su izquierda.
De activarse el checkbox, ese par√°metro ser√° usado como filtro a la lista de clientes presentada en el desplegable.
Los filtros son independientes y pueden ser acumulativos.
Para realizar un filtrado correctamente ingresando manualmente el dato, se debe dar Enter luego de ingresarlo.
En el caso de que s√≥lo quede 1 registro en la lista que coincida con los filtros, deber√° seleccionarse autom√°ticamente.
En el caso de no quedar registros luego del filtrado, deber√° mostrase "Sin clientes" en la lista desplegable.

En el panel derecho de control de clientes, se listar√°n todos los productos del cat√°logo con un contador de unidades a sumar a la ficha.
La vista es una versi√≥n reducida, que s√≥lo mostrar√° la foto, el nombre, el precio y el stock actual de cada producto.
El usuario deber√° usar los controles de + y - para modificar las unidades que quiera sumar a la ficha en cuesti√≥n.
En la parte superior de este panel se contar√° con un bloque de filtrado, que permitir√° encontrar f√°cilmente los productos.

Para agregar una ficha a la base, ser√° necesario seleccionar alg√∫n cliente de la lista desplegable, y marcar al menos una unidad de alg√∫n producto.
El resgitro en la colecci√≥n de las fichas tendr√° un campo con el UID del cliente y otro con el UID del producto (o una colecci√≥n).
De esta forma, cada ficha quedar√° referenciada a un cliente y a un producto (o m√°s de uno) de manera din√°mica.
Si se impactan cambios sobre los clientes o sobre los productos, no ser√° necesario impactarlos sobre las fichas para que est√©n actualizadas.

Para buscar una ficha, se deber√°n cargar algunos datos del cliente, que ser√° tomado como punto de partida.
El sistema acepta 5 formas de b√∫squeda:
 - Cliente exacto   ->  Se tomar√° el UID del cliente seleccionado de la lista desplegable.
                        Se mostrar√° una pantalla con todas las fichas registradas para dicho cliente.
                        El usuario deber√° seleccionar una de las opciones disponibles para avanzar.
 - Por nombre       ->  Se deber√° cargar un nombre en el control de "Nombre".
                        Se mostrar√° una pantalla con todas las fichas registradas para dicho nombre.
                        Esto puede traer fichas de distintos clientes, siempre que compartan el nombre buscado.
                        El usuario deber√° seleccionar una de las opciones disponibles para avanzar.
 - Por apellido     ->  Se deber√° cargar un apellido en el control de "Apellido".
                        Se mostrar√° una pantalla con todas las fichas registradas para dicho apellido.
                        Esto puede traer fichas de distintos clientes, siempre que compartan el apellido buscado.
                        El usuario deber√° seleccionar una de las opciones disponibles para avanzar.
 - Por zona         ->  Se deber√° seleccionar una zona del men√∫ desplegable de zonas disponibles.
                        Se mostrar√° una pantalla con todas las fichas registradas para dicha zona.
                        Esto puede traer fichas de distintos clientes, siempre que compartan la zona buscada.
                        El usuario deber√° seleccionar una de las opciones disponibles para avanzar.
 - Por fecha        ->  Se deber√° seleccionar una fecha en el control de "Fecha".
                        Se mostrar√° una pantalla con todas las fichas registradas para dicha fecha.
                        Esto puede traer fichas de distintos clientes, siempre que compartan la fecha buscada.
                        El usuario deber√° seleccionar una de las opciones disponibles para avanzar.
Seleccionada una ficha, se pasar√° a una pantalla similar donde se mostrar√°n los mismos paneles, pero con los datos de la ficha buscada.

Para editar la ficha seleccionada, se pueden modificar tanto los datos del cliente como de los productos.
En el caso de los clientes, mediante los controles se puede filtrar la lista y seleccionar otra persona para que figure en la ficha.
En el caso de los productos, se listar√°n s√≥lo los productos que contenga la ficha y se podr√°n modificar las cantidades.
A futuro, se agregar√°n controles para poder adicionar productos a la ficha registrada.

Para eliminar la ficha seleccionada, simplemente se debe confirmar la acci√≥n mediante el bot√≥n.

------------------------------------------------------------------------------------------

### Men√∫ de promociones

Por implementar. No estar√° disponible en la primer versi√≥n productiva;

------------------------------------------------------------------------------------------

### Men√∫ de recorrido;

Por implementar. No estar√° disponible en la primer versi√≥n productiva;



------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------


## Estado actual del proyecto

Ya se cuenta con las colecciones en Firebase generadas y utilizadas correctamente.
Se permite la creaci√≥n de cuentas y el logueo correctamente.
Se permite otorgar los permisos de GMail y de Dropbox para los servicios extras.
Se cuenta con los men√∫es de logueo, clientes, productos y fichas funcionales.

En el men√∫ de clientes:
 - Se permite agregar nuevos clientes;
 - Se permite volcar la colecci√≥n de clientes a una planilla de Excel online;
 - Resta implementar la b√∫squeda de clientes;
 - Resta implementar la edici√≥n de clientes;
 - Resta implementar la eliminaci√≥n de clientes;

En el men√∫ de productos:
 - Se permite ver el cat√°logo completo;
 - Se permite acceder a la pantalla de edici√≥n o eliminaci√≥n de un producto en particular desde su presentaci√≥n;
 - Se permite agregar nuevos productos;
 - Resta implementar la zona de filtros para la b√∫squeda de productos;
 - Resta enlazar el bot√≥n de "Editar" a la b√∫squeda y edici√≥n de un producto;
 - Resta enlazar el bot√≥n de "Eliminar" a la b√∫squeda y eliminaci√≥n de un producto;

En el men√∫ de fichas:
 - Se permite acceder al listado de clientes y filtrarlo;
 - Se permite acceder al cat√°logo completo de productos;
 - Se permite crear una nueva ficha;
 - Se permite buscar las fichas seg√∫n varios criterios de b√∫squeda;
 - Se permite efitar una ficha;
 - Se permite eliminar una ficha;
 - Resta agregar el filtrado de productos en el panel de productos;
 - Resta poder agregar nuevos productos en la edici√≥n de las fichas;
 - Resta agregar el control de la fecha de venta de la ficha

Los entornos de desarrollo (Dev) y producci√≥n (Prod) ya se encuentran correctamente configurados y en funcionamiento.


------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------


√öltima revisi√≥n     ->  11/10/2025
Rama en desarrollo  ->  mod0020
Feature en proceso  ->  Refactorizaci√≥n de la estructura de datos almacenadas en los documentos de las fichas

Y esta estructura de archivos:

valen_market_admin/
‚îÇ
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îÇ‚îÄ‚îÄ icons/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Todos los archivos de √≠conos usados en la app, en formato svg
‚îÇ   ‚îî‚îÄ‚îÄ images/
‚îÇ       ‚îî‚îÄ‚îÄ Todas las im√°genes que se usan en la app
‚îÇ
‚îú‚îÄ‚îÄ integration_test/
‚îÇ   ‚îÇ‚îÄ‚îÄ agregar_cliente_flow_test.dart.dart
‚îÇ   ‚îî‚îÄ‚îÄ driver.dart
‚îÇ
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ‚îÄ‚îÄ Android_flow/
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ features/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ catalogo/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ catalogo_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ clientes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ agregar_cliente_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ buscar_cliente_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ clientes_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ fichas/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ fichas_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ home/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ home_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ recorrido/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ recorrido_screen.dart
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ widgets/
‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ custom_big_button.dart
‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ custom_bottom_navbar.dart
‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ custom_home_button.dart
‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ custom_info_card.dart
‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ custom_opciones_desplegables.dart
‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ custom_simple_information.dart
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ custom_top_bar.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ environment.dart
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ firebase_options_dev.dart
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ firebase_options_prod.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ constants/
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ app_colors.dart
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ assets.dart
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ keys.dart
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ pantallas.dart
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ textos.dart
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ zonas_disponibles.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ dropbox/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dropbox_servicios_web.dart
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ firebase/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ auth_servicios_firebase_web.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ catalogo_servicios_firebase.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ clientes_servicios_firebase.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ dropbox_keys.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ fichas_servicios_firebase.dart
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ google/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ clientes_servicios_google_sheets_web.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validador_texto.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ web_flow/
‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ features/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ catalogo/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ web_agregar_producto_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ web_catalogo_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ web_editar_producto_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ web_ver_catalogo_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ clientes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ web_agregar_cliente_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ web_clientes_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ dropbox/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ web_dropbox_auth_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ web_dropbox_check_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ fichas/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ Models/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ cliente_ficha_model.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ fechas_ficha_model.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ producto_ficha_model.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ pago_item_model.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ pagos_ficha_model.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ficha_model.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ Provider/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ cliente_ficha_provider.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ fechas_ficha_provider.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ producto_ficha_provider.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   |‚îÄ‚îÄ pagos_ficha_provider.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ficha_en_curso_provider.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ web_fichas_agregar_buscar_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ web_fichas_editar_eliminar_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ home/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ web_home_screen.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ‚îÄ‚îÄ planillas/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ web_planilla_de_cobros.dart
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ web_login_email_password_screen.dart
‚îÇ   ‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ web_login_screen.dart
‚îÇ   ‚îÇ   ‚îÇ           ‚îÇ‚îÄ‚îÄ web_register_screen.dart
‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ web_registration_waiting_screen.dart
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ widgets/
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_agregar_producto_bloque.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_bloque_con_titulo.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_button_styles.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_campo_con_checkbox_dropdown.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_campo_con_checkbox_textfield.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_campo_fecha_con_checkbox.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_campo_frecuencia_aviso.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_campo_sin_checkbox_textfield.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_dropdown_clientes.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_ficha_cliente_section.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_ficha_fechas_section.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_ficha_productos_section.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_ficha_shop_item.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_gradient_button.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_popup_resultados_busqueda.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_popup_selector_criterio_busqueda.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_shop_item_description.dart
‚îÇ   ‚îÇ       ‚îÇ‚îÄ‚îÄ custom_web_text_field.dart
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ custom_web_top_bar.dart
‚îÇ   ‚îÇ
‚îÇ   ‚îÇ‚îÄ‚îÄ main_common.dart
‚îÇ   ‚îÇ‚îÄ‚îÄ main_dev.dart
‚îÇ   ‚îî‚îÄ‚îÄ main_prod.dart
‚îÇ
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îî‚îÄ‚îÄ clientes_crud_test.dart
‚îÇ
‚îî‚îÄ‚îÄ firebase.json

Adem√°s, estas son las reglas de dise√±o obligatorias para todo el proyecto:

 Como puedes ver, el proyecto es √∫nico, pero tiene 2 entradas:
 - lib/main_dev.dart -> Para el ambiente de desarrollo
 - lib/main_prod.dart -> Para el ambiente de producci√≥n

 Ahora me encuentro trabajando en la mod0020 -> Refactorizaci√≥n de la estructura de datos almacenadas en los documentos de las fichas 

 Dime si se entiende bien la estructura del proyecto, as√≠ comenzamos a trabajar en el nuevo desarrollo


------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------


Ejemplo pr√°ctico de una ficha:
Ficha
{
  "ID": asdasdasdasd,
  "NumeroDeFicha": 30,
  "Cliente": {
    "UID": "75298AzAX4UeaGCvm0Wl",
    "Nombre": "fabian",
    "Apellido": "gertie",
    "Zona": "Norte"
    "Direccion": "Calle falsa 123",
    "Telefono": "1122334455",
  },
  "Fechas": {
    "FechaDeCreacion": "2025-10-10",
    "FechaDeVenta": "2025-09-28",
    "FechaDeProximoAviso": "2025-10-24"
  },
  "Productos": [
    {
      "UID": "EXs51qPRfvggQ0Jftt6f",
      "Nombre": "Agujereadora",
      "PrecioUnitario": 18000,
      "PrecioDeLasCuotas": 1500,
      "Unidades": 2
    },
    {
      "UID": "MROSzBJf0bJHnTbin1ZU",
      "Nombre": "Reloj inteligente",
      "PrecioUnitario": 45000,
      "PrecioDeLasCuotas": 3750,
      "Unidades": 1
    }
  ],
  "Pagos": {
    "CantidadDeCuotas": 12,
    "ImporteTotal": 81000,
    "ImporteCuota": 6750,
    "ImporteSaldado": 16750,
    "Restante": 64250,
    "CuotasPagas": 2,
    "Saldado": false,
    "PagosRealizados": [
      {
        "Fecha": "2025-10-05T00:00:00-03:00",
        "Medio": "Efectivo",
        "Monto": 6750
      },
      {
        "Fecha": "2025-10-14T00:00:00-03:00",
        "Medio": "Transferencia",
        "Monto": 10000
      }
    ]
  }
}



------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------


Definici√≥n de los Sub Providers

/// ---------------------------------------------------------------------------
/// CLIENTE_FICHA_PROVIDER
///
/// üîπ Rol general:
/// Administra los datos del cliente asociado a la ficha en curso.
/// Representa una capa intermedia entre la UI y el modelo [ClienteFichaModel].
///
/// üîπ Forma de uso:
///   - Este provider es de uso interno dentro de [FichaEnCursoProvider].
///   - No debe ser accedido directamente por los Widgets.
///   - Su responsabilidad es mantener un √∫nico cliente activo.
///
/// üîπ Interact√∫a con:
///   - [FichaEnCursoProvider]: usa sus m√©todos p√∫blicos para actualizar el cliente.
///   - [ClienteFichaModel]: modelo de datos del cliente.
///
/// üîπ L√≥gica principal:
///   - Permite establecer un cliente mediante `setCliente()`.
///   - Provee acceso a trav√©s del getter `cliente`.
///   - Permite limpiar el estado (reiniciar los datos del cliente).
///
/// üîπ M√©todos disponibles:
///   ‚Ä¢ `ClienteFichaModel get cliente` ‚Üí Obtiene el cliente actual.
///   ‚Ä¢ `void setCliente(ClienteFichaModel cliente)` ‚Üí Define un nuevo cliente.
///   ‚Ä¢ `void limpiarCliente()` ‚Üí Restablece los valores vac√≠os.
///
/// ---------------------------------------------------------------------------


/// ---------------------------------------------------------------------------
/// FECHAS_FICHA_PROVIDER
///
/// üîπ Rol general:
/// Administra y normaliza las fechas asociadas a la ficha (creaci√≥n, venta,
/// y pr√≥ximo aviso). Encapsula un modelo [FechasFichaModel].
///
/// üîπ Forma de uso:
///   - Se utiliza exclusivamente dentro de [FichaEnCursoProvider].
///   - No debe ser accedido directamente por los Widgets.
///
/// üîπ Interact√∫a con:
///   - [FichaEnCursoProvider]: mediante los m√©todos `actualizarFechas()` y `cargarDesdeMap()`.
///   - [FechasFichaModel]: modelo que define las tres fechas.
///
/// üîπ L√≥gica principal:
///   - Permite asignar un nuevo modelo de fechas mediante `setFechas()`.
///   - Permite reiniciar el estado mediante `limpiarFechas()`.
///
/// üîπ M√©todos disponibles:
///   ‚Ä¢ `FechasFichaModel get fechas` ‚Üí Obtiene las fechas actuales.
///   ‚Ä¢ `void setFechas(FechasFichaModel fechas)` ‚Üí Reemplaza el modelo completo.
///   ‚Ä¢ `void limpiarFechas()` ‚Üí Reinicia las fechas (mantiene la de creaci√≥n actual).
///
/// ---------------------------------------------------------------------------


/// ---------------------------------------------------------------------------
/// PAGOS_FICHA_PROVIDER
///
/// üîπ Rol general:
/// Administra el registro y control de pagos realizados en una ficha.
/// Calcula autom√°ticamente los valores dependientes: restante, cuotas pagas,
/// importe saldado y estado ‚Äúsaldado‚Äù.
///
/// üîπ Forma de uso:
///   - Solo se accede desde [FichaEnCursoProvider].
///   - No debe ser accedido directamente por los Widgets.
///
/// üîπ Interact√∫a con:
///   - [FichaEnCursoProvider]: a trav√©s de `registrarPago()` y `actualizarFichaMedianteID()`.
///   - [PagosFichaModel] y [PagoItemModel]: modelos de estructura de pagos.
///
/// üîπ L√≥gica principal:
///   - Registra nuevos pagos, recalculando autom√°ticamente totales.
///   - Admite registro desde objetos (`agregarPago()`) o mapas (`registrarPagoDesdeMapa()`).
///   - Permite limpiar completamente el historial de pagos.
///
/// üîπ M√©todos disponibles:
///   ‚Ä¢ `PagosFichaModel get pagos`
///   ‚Ä¢ `void setPagos(PagosFichaModel nuevosPagos)`
///   ‚Ä¢ `void agregarPago(PagoItemModel nuevoPago)`
///   ‚Ä¢ `void registrarPagoDesdeMapa(Map<String, dynamic> pagoMap)`
///   ‚Ä¢ `void limpiarPagos()`
///
/// ---------------------------------------------------------------------------


/// ---------------------------------------------------------------------------
/// PRODUCTO_FICHA_PROVIDER
///
/// üîπ Rol general:
/// Gestiona la lista de productos asociados a la ficha en curso.
/// Es responsable de mantener coherencia en unidades, precios y cuotas.
///
/// üîπ Forma de uso:
///   - Se utiliza solo dentro de [FichaEnCursoProvider].
///   - No debe ser accedido directamente por los Widgets.
///
/// üîπ Interact√∫a con:
///   - [FichaEnCursoProvider]: mediante sus m√©todos de alto nivel:
///       ‚Ä¢ `modificarCantidadDeProducto()`
///       ‚Ä¢ `actualizarValoresDelProducto()`
///   - [ProductoFichaModel]: modelo individual de producto.
///
/// üîπ L√≥gica principal:
///   - Permite agregar, actualizar o eliminar productos.
///   - Actualiza cantidades y datos financieros de forma controlada.
///   - Mantiene la lista en estado inmutable hacia el exterior.
///
/// üîπ M√©todos disponibles:
///   ‚Ä¢ `List<ProductoFichaModel> get productos`
///   ‚Ä¢ `void agregarProducto(ProductoFichaModel producto)`
///   ‚Ä¢ `void eliminarProductoPorUID(String uidProducto)`
///   ‚Ä¢ `void actualizarCantidadDeProducto(String uidProducto, int nuevaCantidad)`
///   ‚Ä¢ `void actualizarValoresDelProducto({ ... })`
///   ‚Ä¢ `void limpiarProductos()`
///
/// ---------------------------------------------------------------------------


------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------

Definici√≥n del Provider (Este es el √∫nico punto de contacto entre UI y sub-providers / servicios)

/// ---------------------------------------------------------------------------
/// FICHA_EN_CURSO_PROVIDER
///
/// üîπ Rol general:
/// Gestiona el estado global de la ficha actualmente en edici√≥n o creaci√≥n
/// dentro del flujo web. Centraliza la interacci√≥n entre la UI, los modelos
/// de ficha (`FichaModel`) y el servicio de Firebase (`FichasServiciosFirebase`).
///
/// üîπ Forma de uso:
/// Este provider debe utilizarse a trav√©s de `ref.watch(fichaEnCursoProvider)`
/// o `ref.read(fichaEnCursoProvider.notifier)` dentro de widgets `ConsumerWidget`
/// o `ConsumerStatefulWidget`.
///
/// - Nunca acceder directamente a los subproviders internos.
/// - Toda modificaci√≥n (cliente, fechas, productos, pagos) debe pasar por los
///   m√©todos p√∫blicos de `FichaEnCursoProvider`.
///
/// üîπ Interact√∫a con:
///   - [ClienteFichaProvider]: gestiona la informaci√≥n del cliente.
///   - [FechasFichaProvider]: controla fechas de creaci√≥n, venta y pr√≥ximo aviso.
///   - [ProductoFichaProvider]: maneja la lista de productos dentro de la ficha.
///   - [PagosFichaProvider]: registra y actualiza los pagos realizados.
///   - [FichasServiciosFirebase]: sincroniza con la base de datos Firestore.
///
/// üîπ L√≥gica principal:
///   - Permite crear, actualizar o eliminar fichas en Firebase.
///   - Mantiene la ficha en curso en memoria mientras se edita.
///   - Expone m√©todos de conveniencia para acceder a datos espec√≠ficos.
///   - Gestiona coherencia interna entre subproviders (cliente, fechas, pagos, etc.).
///
/// üîπ Estados:
///   - `estaVacia`: no hay cliente ni productos cargados.
///   - `esValida`: lista para guardarse (cliente v√°lido + productos cargados).
///
/// ---------------------------------------------------------------------------
///
/// üî∏ INTERFACES Y M√âTODOS DISPONIBLES
/// ---------------------------------------------------------------------------
///
/// ‚ñ∂Ô∏è CLIENTE
/// - `void actualizarCliente(Map<String, dynamic> clienteMap)`
///   Carga o modifica los datos del cliente actual.
///
/// ‚ñ∂Ô∏è FECHAS
/// - `void actualizarFechas(Map<String, dynamic> fechasMap)`
///   Establece las fechas de la ficha (creaci√≥n, venta, aviso).
///
/// ‚ñ∂Ô∏è PAGOS
/// - `void registrarPago(Map<String, dynamic> pagoMap)`
///   Agrega un nuevo pago a la lista interna de pagos.
///
/// ‚ñ∂Ô∏è IDENTIFICADORES
/// - `void setId(String? id)`
///   Define el ID de la ficha actual (usado para actualizaci√≥n en Firebase).
///
/// - `void setNumeroDeFicha(int nuevoNumero)`
///   Establece el n√∫mero correlativo de ficha.
///
/// ‚ñ∂Ô∏è PRODUCTOS
/// - `void modificarCantidadDeProducto({required String uidProducto, required bool incrementar, required Map<String, dynamic> datosCatalogo})`
///   Incrementa o decrementa la cantidad de unidades de un producto, agreg√°ndolo o quit√°ndolo seg√∫n corresponda.
///
/// - `void actualizarValoresDelProducto({...})`
///   Permite modificar precio unitario, cuotas o importe de cuotas de un producto ya existente.
///
/// - `void actualizarProductos(List<Map<String, dynamic>> productosMap)`
///   Reemplaza la lista completa de productos (por ejemplo, al cargar una ficha guardada).
///
/// ‚ñ∂Ô∏è CONSTRUCCI√ìN Y CARGA DE FICHAS
/// - `FichaModel construirFichaCompleta()`
///   Construye un objeto `FichaModel` a partir del estado actual del provider.
///
/// - `void cargarDesdeFichaModel(FichaModel ficha)`
///   Carga el estado interno desde un modelo ya existente.
///
/// - `void cargarDesdeMap(Map<String, dynamic> data)`
///   Restaura el estado a partir de un mapa (por ejemplo, obtenido de Firebase).
///
/// ‚ñ∂Ô∏è VALIDACI√ìN Y ESTADO
/// - `bool get esValida`
///   Retorna `true` si la ficha tiene cliente y productos cargados.
///
/// - `bool get estaVacia`
///   Retorna `true` si no hay cliente ni productos cargados.
///
/// ‚ñ∂Ô∏è LIMPIEZA
/// - `void limpiarFicha()`
///   Reinicia completamente el estado de la ficha en curso.
///
/// ‚ñ∂Ô∏è SINCRONIZACI√ìN CON FIREBASE
/// - `Future<void> guardarFicha()`
///   Crea una nueva ficha en Firebase (solo si no tiene ID asignado).
///
/// - `Future<void> actualizarFichaMedianteID()`
///   Actualiza una ficha existente en Firebase.
///
/// - `Future<void> eliminarFichaMedianteID()`
///   Elimina una ficha en Firebase y limpia el estado local.
///
/// - `Future<void> cargarFichaMedianteID()`
///   Descarga y carga una ficha existente desde Firebase.
///
/// ‚ñ∂Ô∏è CONSULTAS POR FILTROS (Firebase)
/// - `Future<List<FichaModel>> obtenerFichasMedianteID()`
/// - `Future<List<FichaModel>> obtenerFichasMedianteNombre()`
/// - `Future<List<FichaModel>> obtenerFichasMedianteApellido()`
/// - `Future<List<FichaModel>> obtenerFichasMedianteZona()`
/// - `Future<List<FichaModel>> obtenerFichasMedianteFechaVenta()`
/// - `Future<List<FichaModel>> obtenerFichasMedianteFechaAviso()`
///
/// ‚ñ∂Ô∏è GETTERS DE ACCESO SIMPLIFICADO (para UI)
/// - `String? get uidCliente`
/// - `String? get nombreCliente`
/// - `String? get apellidoCliente`
/// - `String? get zonaCliente`
/// - `String? get direccionCliente`
/// - `String? get telefonoCliente`
/// - `DateTime? get fechaDeVenta`
/// - `DateTime? get proximoAviso`
/// - `List<ProductoFichaModel> get productos`
/// - `PagosFichaModel get pagos`
///
/// ---------------------------------------------------------------------------


------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------


Reglas operativas (a aplicar estrictamente)

Interfaces Map-only:
  - Los Widgets SIEMPRE pasan/reciben Map<String,dynamic> a/desde el FichaEnCursoProvider, no pasar√°n objetos parciales o variables sueltas.
  - Ejemplo: actualizarCliente(Map)

Provider como √∫nica capa que habla con servicios:
  - La UI no llama a FichasServiciosFirebase ni a m√©todos Firebase directamente.
  - Ejemplo: await ref.read(fichaEnCursoProvider).CrearFichaEnFirebase();

Sub-providers encapsulados:
  - Ning√∫n otro archivo (widgets/pantallas) debe importar o manipular ClienteFichaProvider, FechasFichaProvider, ProductoFichaProvider o PagosFichaProvider directamente.
  - Todo a trav√©s de FichaEnCursoProvider.

Nombres de campos:
  - Para mapear a Firestore o entre capas, usar las constantes de fieldNames.dart en toMap() y fromMap() de los modelos.



------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------


Operaciones con Firebase para fichas

/// ---------------------------------------------------------------------------
/// FICHAS_SERVICIOS_FIREBASE
///
/// üîπ Rol general:
/// Servicio de persistencia encargado de la interacci√≥n con Firestore para
/// crear, leer, actualizar y eliminar fichas de clientes.
///
/// üîπ Forma de uso:
///   - Se utiliza internamente desde [FichaEnCursoProvider].
///   - Cada m√©todo se comunica con la colecci√≥n `BDD_Fichas`.
///
/// üîπ Interact√∫a con:
///   - [FichaModel]: modelo principal que encapsula todos los submodelos.
///   - Firestore (`FirebaseFirestore`): colecci√≥n `BDD_Fichas` y documento `config/fichas`.
///
/// üîπ L√≥gica principal:
///   - Permite CRUD completo de fichas en Firestore.
///   - Aplica normalizaci√≥n de fechas.
///   - Controla la numeraci√≥n consecutiva de fichas mediante `obtenerYSiguienteNumeroFicha()`.
///   - Ofrece m√©todos de consulta por distintos filtros (ID, nombre, zona, fechas).
///
/// üîπ M√©todos principales:
///   ‚Ä¢ `Future<String> CrearFichaEnFirebase(FichaModel ficha)`
///   ‚Ä¢ `Future<void> ActualizarFichaEnFirebase(String fichaId, FichaModel ficha)`
///   ‚Ä¢ `Future<void> EliminarFichaEnFirebase(String fichaId)`
///   ‚Ä¢ `Future<FichaModel?> CargarFichaDesdeFirebaseMedianteIDCliente(String fichaId)`
///   ‚Ä¢ `Future<List<FichaModel>> ObtenerFichasDesdeFirebaseMediante...()`
///   ‚Ä¢ `Future<int> obtenerYSiguienteNumeroFicha()`
///
/// ---------------------------------------------------------------------------


Operaciones con Firebase para cat√°logo

/// ---------------------------------------------------------------------------
/// CATALOGO_SERVICIOS_FIREBASE
///
/// üîπ Rol general:
/// Gestiona la colecci√≥n `BDD_Catalogo` en Firestore, encarg√°ndose de las
/// operaciones CRUD sobre los productos disponibles en el sistema.
///
/// üîπ Forma de uso:
///   - Utilizado por widgets y providers que necesiten mostrar o actualizar
///     el cat√°logo de productos (por ejemplo, en la selecci√≥n de productos
///     dentro de la ficha).
///
/// üîπ Interact√∫a con:
///   - Firestore (`FirebaseFirestore`): colecci√≥n `BDD_Catalogo`.
///   - Constantes de `fieldNames.dart` para garantizar nombres uniformes.
///
/// üîπ L√≥gica principal:
///   - Agrega nuevos productos con timestamp de creaci√≥n.
///   - Obtiene productos por ID o todos los registros.
///   - Actualiza y elimina registros existentes.
///
/// üîπ M√©todos disponibles:
///   ‚Ä¢ `Future<void> agregarProducto({...})`
///   ‚Ä¢ `Future<List<Map<String, dynamic>>> obtenerTodosLosProductos()`
///   ‚Ä¢ `Future<Map<String, dynamic>?> obtenerProductoPorId(String id)`
///   ‚Ä¢ `Future<void> actualizarProducto({...})`
///   ‚Ä¢ `Future<void> eliminarProducto(String id)`
///
/// ---------------------------------------------------------------------------


------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------

Encabezado de cada archivo, para describirlo

/// ---------------------------------------------------------------------------
/// NOMBRE DEL WIDGET
///
/// üîπ Rol: Descripc√≥n de funcionamiento.
/// üîπ Interact√∫a con:
///   - [Nombre del Widget]:
///       ‚Ä¢ ¬øC√≥mo inteact√∫a?.
/// üîπ L√≥gica:
///   - L√≥gica de funcionamiento
/// ---------------------------------------------------------------------------